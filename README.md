# MalwareGraphAnalyser

Tool designed to extract PE methods into matrix and compare them with other methods.  
**Still in progress**  

## TODO

- [x] Extract CFG
- [x] Export Graph -> png
- [x] Save graph -> gml
- [ ] Similarity / Hash /Distance
- [x] Load new graph
- [x] Graph Matching
- [ ] Hash basic bloc (LSH)
- [ ] Subgraph distance / Matching

Displays the methods of the binary and the corresponding matrices. Matrices are limited to 9 nodes.  

```
python MalwareGraph.py notepad.exe

fcn.1400025bc
[[0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0.]
 [0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0.]]
 
           Method Node
1   fcn.140001a20    5
2   fcn.1400022f8    2
3   fcn.140001c6c    5
4   fcn.1400010dc    1
6   fcn.140001cd0    5
7   fcn.140001de0    4
9   fcn.140001424    3
10  fcn.140001188    5
11  fcn.140001cac    1
12  fcn.140002418    7
13  fcn.140002470    1
14  fcn.1400024d0    4
16  fcn.140001cf4    5
17  fcn.1400023bc    7
18  fcn.140002530    5
19  fcn.140002480    6
20  fcn.1400025bc    6

```

Export all the graphs of the binary methods in gml format  

```
python MalwareGraph.py ../calc.exe -e
```

Analyse imported graph with all graphs from another PE file  

```
python cfg.py ../../Downloads/7a9130960b9ac94c4de7ce836d61e3bbd2b6602aab647e22bf032ae1f2ae0acf -i _fcn.08060b13.gml
['../../Downloads/7a9130960b9ac94c4de7ce836d61e3bbd2b6602aab647e22bf032ae1f2ae0acf']
Nombre de m√©thodes : 128
     Method Name  GED  Isomoprhism  Bipartite
0   fcn.08060d50  1.0            0          1
1   fcn.0805e83e  0.0            0          0
2   fcn.0805e5b3  0.0            0          1
3   fcn.080606af  0.0            0          0
4   fcn.0805cea0  0.0            0          0
5   fcn.0805e784  0.0            0          0
6   fcn.0805e5e1  0.0            0          0
7   fcn.0805e62d  0.0            0          1
8   fcn.0805e692  0.0            0          0
9   fcn.0805eb14  2.0            0          0
10  fcn.0805e74e  0.0            0          0
11  fcn.0805eb2f  0.0            0          0
12  fcn.0805e653  0.0            0          1
13  fcn.0805e2b0  0.0            0          1
14  fcn.0805e607  0.0            1          0
15  fcn.08060b93  0.0            0          1
16  fcn.0805e70f  0.0            1          0
17  fcn.0805e86c  0.0            0          1
18  fcn.0805e7c3  0.0            1          0
19  fcn.0805e574  0.0            0          0
20  fcn.0805eec3  0.0            0          1
21  fcn.08060aa2  0.0            0          1
22  fcn.080609eb  0.0            0          0
23  fcn.08060744  0.0            1          0
24  fcn.08060ae1  0.0            0          0
25  fcn.0806071c  3.0            0          0
26  fcn.08060b13  0.0            0          0
27  fcn.08060a1d  0.0            0          1
28  fcn.0806098c  0.0            1          0
29  fcn.080609b2  0.0            0          1
30  fcn.08060966  0.0            0          1
31  fcn.080606e1  0.0            0          0
32  fcn.08060cfc  0.0            0          0

``` 
