# MalwareGraphAnalyser

Tool designed to extract PE methods into matrix and compare them with other methods.

## TODO

- [x] Extract CFG
- [x] Export Graph -> png
- [x] Save graph -> gml
- [ ] Similarity / Hash /Distance
- [ ] Load new graph
- [ ] Graph Matching


Displays the methods of the binary and the corresponding matrices. Matrices are limited to 9 nodes.  

```
python MalwareGraph.py notepad.exe

fcn.1400025bc
[[0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0.]
 [0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0.]]
 
           Method Node
1   fcn.140001a20    5
2   fcn.1400022f8    2
3   fcn.140001c6c    5
4   fcn.1400010dc    1
6   fcn.140001cd0    5
7   fcn.140001de0    4
9   fcn.140001424    3
10  fcn.140001188    5
11  fcn.140001cac    1
12  fcn.140002418    7
13  fcn.140002470    1
14  fcn.1400024d0    4
16  fcn.140001cf4    5
17  fcn.1400023bc    7
18  fcn.140002530    5
19  fcn.140002480    6
20  fcn.1400025bc    6

```

Export all the graphs of the binary methods in gml format  

```
python MalwareGraph.py ../calc.exe -e
```

Analyse imported graph with all graphs from another PE file  

```
python cfg.py ../notepad.exe -i _fcn.1400025bc.gml

['../notepad.exe']
Nombre de m√©thodes : 138
Calcul graph distance. Plz Wait ...
Distance between _fcn.1400025bc.gml and fcn.140003c68 : 4.0
Calcul graph distance. Plz Wait ...
Distance between _fcn.1400025bc.gml and fcn.140003f24 : 3.0
Calcul graph distance. Plz Wait ...
Distance between _fcn.1400025bc.gml and fcn.1400051a8 : 3.0
Calcul graph distance. Plz Wait ...
Distance between _fcn.1400025bc.gml and fcn.140015360 : 5.0
Calcul graph distance. Plz Wait ...
Distance between _fcn.1400025bc.gml and fcn.140019570 : 4.0
Calcul graph distance. Plz Wait ...
Distance between _fcn.1400025bc.gml and fcn.140019968 : 0.0
isomorphism find for :fcn.140019968
``` 
